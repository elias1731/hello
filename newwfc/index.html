<!DOCTYPE html>
<html lang="en">
<head>
    <title>‚ú® MKW Deluxe X</title>
    <meta name="description" content="NewWFC MKW Deluxe X Stats"/>
    <meta name="author" content="heyFordy.de" />
    <meta name="theme-color" content="#00aeff"/>
    <link rel="apple-touch-icon" href="./assets/icon.png" />
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
    <meta name="apple-mobile-web-app-title" content="‚ú®MKW DX" />
    
    <link rel="icon" href="./assets/dx.png" sizes="any" />
    <link rel="stylesheet" href="./assets/style.css" type="text/css" />
    <link href="./assets/mii-font.css" rel="Stylesheet" type="text/css" />
    <link href="./assets/Rubik.css" rel="Stylesheet" type="text/css" />

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, viewport-fit=cover">
    <script src="./assets/pwa.js"></script>
</head>
<body>
    <header>
        <h1 class="rainbow-text"><img src="./assets/dx.png" alt="DELUXE X" class="header-logo" onclick="toggle_info_modal()" style="cursor: pointer;">MKW Deluxe X</h1>
        <div id="header-stats" class="hidden"><span id="header-stats-content"></span></div>
        <div class="header-buttons">
             <button id="user-profile-btn" title="User Profile"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="1em" height="1em"> <path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/> <path d="M0 0h24v24H0z" fill="none"/> </svg> </button>
             <button id="settings-btn" title="Settings">‚öô</button>
        </div>
    </header>

    <div id="filter-indicator" style="display: none;"> <span>‚ÑπÔ∏è</span> Room filter applied. <button onclick="disable_filter()">Show all</button> </div>

    <main>
        <div id="loading">‚è≥ Loading data...</div>
        <div id="not-found-container" style="display: none;">Room not found or closed.</div>
        <div id="rooms-container"></div>
    </main>

    <div id="settings-modal" class="modal hidden">
        <div class="modal-content">
            <button class="modal-close-btn top-right" onclick="toggle_settings_modal()">√ó</button>
            <h2>Settings</h2>
            <div class="setting-row"> 
                <label>View Mode:</label> 
                <div class="view-mode-container">
                    <button id="view-mode-mobile-btn" class="view-mode-btn" onclick="set_view_mode('mobile')" title="Mobile">üì±</button> 
                    <button id="view-mode-desktop-btn" class="view-mode-btn" onclick="set_view_mode('desktop')" title="Desktop">üíª</button>
                </div> 
            </div>
            <div class="setting-row"> <button id="favorites-btn" onclick="toggle_favorites_modal()">‚≠ê Favorites</button> </div>
            <div class="setting-row"> 
                <label>Dark mode</label> 
                <label class="switch">
                    <input type="checkbox" id="darkmode-checkbox" onchange="on_darkmode_change()" />
                    <span class="slider round"></span>
                </label> 
            </div>
            <div class="setting-row"> <label>Show counts</label> <label class="switch"><input type="checkbox" id="header-stats-checkbox" onchange="on_header_stats_change()" /><span class="slider round"></span></label> </div>
            <div class="setting-row"> <label>Sort by:</label> <select id="sort-order-select" onchange="on_sort_order_change()"> <option value="player_count">Player count</option> <option value="time_created">Time created</option> </select> </div>
            <div class="setting-row"> <label>Auto-Refresh</label> <label class="switch"><input type="checkbox" id="timeout-checkbox" onchange="on_checkbox()" /><span class="slider round"></span></label> </div>
            <div class="setting-row"> <label>Show Friend Rooms</label> <label class="switch"><input type="checkbox" id="private-checkbox" onchange="on_private_checkbox()" /><span class="slider round"></span></label> </div>
            <div class="setting-row"> <label>Underline OpenHost</label> <label class="switch"><input type="checkbox" id="openhost-checkbox" onchange="on_openhost_checkbox()" /><span class="slider round"></span></label> </div>
        </div>
    </div>

    <div id="favorites-modal" class="modal hidden">
         <div class="modal-content">
             <button class="modal-close-btn top-right" onclick="toggle_favorites_modal()">√ó</button>
             <h2>‚≠ê Favorites</h2>
             <div class="setting-row user-search-container">
                 <input type="text" id="fav-manual-fc" placeholder="Enter FC (####-####-####)">
                 <button class="search-icon-btn" onclick="manual_add_favorite()">Add</button>
             </div>
             <p style="font-size: 0.8em; margin-bottom: 10px; opacity: 0.7;">Click a player in the list or enter FC above.</p>
             <div id="favorites-list-container"> <div id="favorites-list"> <p>No favorites added yet.</p> </div> </div>
         </div>
     </div>

     <div id="user-profile-modal" class="modal hidden">
          <div class="modal-content">
              <button class="modal-close-btn top-right" onclick="toggle_user_profile_modal()">√ó</button>
              <h2>User Profile</h2>
              <div id="user-login-view">
                  <div class="setting-row user-search-container">
                       <input type="text" id="user-manual-fc" placeholder="Enter your FC">
                       <button class="search-icon-btn" onclick="manual_set_user()">Set</button>
                  </div>
                  <p style="font-size: 0.8em; opacity: 0.7; text-align: center;">Click on a player in the list to select them as your profile.</p>
              </div>
               <div id="user-profile-view" class="hidden">
                  <div id="user-profile-display"></div>
                  <button id="logout-btn" class="modal-close-btn large-logout" onclick="logout_user()">üëã Logout</button>
               </div>
          </div>
      </div>

     <div id="player-info-modal" class="modal hidden">
         <div class="modal-content small-modal">
             <button class="modal-close-btn top-right" onclick="hide_player_info_modal()">√ó</button>
             <div id="player-info-content"></div>
         </div>
     </div>

     <div id="info-modal" class="modal hidden">
         <div class="modal-content small-modal">
             <button class="modal-close-btn top-right" onclick="toggle_info_modal()">√ó</button>
             <img src="./assets/DXLogo.png" alt="Logo" style="width: 100%; max-width: 280px; height: auto; display: block; margin: 0 auto 15px auto;">
             <h2>Info</h2>
             <div class="info-modal-content" style="text-align: center;">
                 <p>MKW Deluxe X | heyfordy.de</p>
                 <div style="margin-top: 1.5rem; display: flex; justify-content: center; gap: 10px;">
                    <button class="modal-close-btn" onclick="clear_all_cache()" style="margin: 0; background-color: #e74c3c;">Clear Cache</button>
                    <button class="modal-close-btn" onclick="location.reload()" style="margin: 0;">Refresh</button>
                 </div>
             </div>
         </div>
     </div>

    <div class="footer-links">
        <p> <a href="https://heyfordy.de" target="_blank" class="footer-button"> heyfordy.de </a> </p>
        <p> <a href="https://heyfordy.de" target="_blank" class="footer-button">¬© 2026</a> </p>
    </div>

    <script src="./dx.js" defer></script>
</body>
</html>